<div align="center">
<pre>
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                   â•‘
â•‘   â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—   â•‘
â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â•‘
â•‘   â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â•‘
â•‘   â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘   â•‘
â•‘   â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â•‘
â•‘   â•šâ•â•     â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â• â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•     â•šâ•â•â•šâ•â•   â•šâ•â•   â•šâ•â•  â•šâ•â•   â•‘
â•‘                                                                                   â•‘
â•‘                              Mediasmith v1.1.0                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
</pre>
</div>
<p align="center">
	<em><code>â¯ Seamlessly watch âœ backup âœ convert your media</code></em>
</p>
<p align="center">
	<img src="https://img.shields.io/github/license/yourname/mediasmith?style=default&logo=opensourceinitiative&logoColor=white&color=0080ff" alt="license">
	<img src="https://img.shields.io/github/last-commit/yourname/mediasmith?style=default&logo=git&logoColor=white&color=0080ff" alt="last-commit">
	<img src="https://img.shields.io/github/languages/top/yourname/mediasmith?style=default&color=0080ff" alt="repo-top-language">
	<img src="https://img.shields.io/github/languages/count/yourname/mediasmith?style=default&color=0080ff" alt="repo-language-count">
</p>

## ğŸ”— Table of Contents
- [ğŸ“ Overview](#-overview)
- [ğŸ‘¾ Features](#-features)
- [ğŸ“ Project Structure](#-project-structure)
- [ğŸš€ Getting Started](#-getting-started)
  - [â˜‘ï¸ Prerequisites](#-prerequisites)
  - [âš™ï¸ Installation](#-installation)
  - [ğŸ¤– Usage](#-usage)
  - [ğŸ§ª Testing](#-testing)
- [ğŸ”° Contributing](#-contributing)
- [ğŸ— License](#-license)
- [ğŸ™Œ Acknowledgments](#-acknowledgments)

---

## ğŸ“ Overview
**Mediasmith** (v1.0.1) is a Bash toolkit that **monitors**, **backs up**, **organizes**, and **converts** multimedia files (video, audio, images) in real time.  
It uses `inotifywait`, `ffmpeg`, and `ImageMagick`, and includes a native POSIXâ€‘threaded helper for highâ€‘performance parallel conversion.

---

## ğŸ‘¾ Features
- **Live watchâ€‘folder**: reacts to new files via `inotifywait` and a `handle_new_file` handler that autoâ€‘backs up and converts.
- **Safe backups**: copies originals into `backup/<timestamp>/` with full directory tree, using `backup.sh` with `init_backup` and `backup_directory`.
- **Oneâ€‘click organisation**: optional sorting into `audio/`, `video/`, and `images/` before processing.
- **Flexible conversion**:
  - **Merge mode**: concat media into one file.
  - **Single mode**: convert fileâ€‘byâ€‘file.
  - **Fork**, **subshell**, or **POSIX threads** (`thread_converter` in C) modes.
  - **Improved thread_converter** logs each threadâ€™s work with timestamp, user, and mutexâ€‘protected output, and cleans up resources.
- **Robust logging**:
  - `logging.sh` writes to `/var/log/convertisseur_multimedia/history.log`.
  - Falls back to `logs/history.log` if `/var/log` is not writable.
  - Uses standardized format: `YYYY-MM-DD-HH-MM-SS : user : LEVEL : message`.
- **Error codes & validation**:
  - `main_script.sh` enforces mutual exclusion of `-f`, `-t`, `-s`.
  - Provides specific exit codes for missing arguments, invalid choices, or permission issues.
- **Selfâ€‘installing**: `deps_check.sh` autoâ€‘installs `ffmpeg`, `inotify-tools`, and `imagemagick` if missing.
- **Portable build**: `Makefile` compiles the C helper and sets up everything with `make all`.

---

## ğŸ“ Project Structure
```text
mediasmith/
â”œâ”€â”€ bin/
â”‚   â””â”€â”€ thread_converter            # POSIXâ€‘threads helper (C, gcc -pthread)
â”œâ”€â”€ backup/                         # timestamped backups
â”œâ”€â”€ config/
â”‚   â””â”€â”€ config.ini                  # default paths & options
â”œâ”€â”€ lib/                            # Bash modules
â”‚   â”œâ”€â”€ backup.sh
â”‚   â”œâ”€â”€ conversion.sh
â”‚   â”œâ”€â”€ logging.sh
â”‚   â”œâ”€â”€ monitor.sh
â”‚   â””â”€â”€ utils.sh
â”œâ”€â”€ logs/
â”‚   â””â”€â”€ history.log                 # fallback logs
â”œâ”€â”€ output/                         # conversion results
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ convertisseur_multimedia.sh # main script (watch, menu, backup, convert)
â”‚   â”œâ”€â”€ deps_check.sh               # dependency installer
â”‚   â””â”€â”€ populate_test_files.sh      # test files generator
â”œâ”€â”€ src/
â”‚   â””â”€â”€ thread_converter.c          # C source for threaded conversion
â”œâ”€â”€ Makefile
â”œâ”€â”€ LICENSE
â””â”€â”€ README.md                       # this file
```

---

## ğŸš€ Getting Started

### â˜‘ï¸ Prerequisites
- Linux (Debian, Ubuntu, CentOS, Fedoraâ€¦)  
- Bash 4+  
- GCC & Make  
- Internet (for first-run installs)

### âš™ï¸ Installation
```bash
git clone https://github.com/yourname/mediasmith.git
cd mediasmith
make all
```
This runs:
1. `scripts/deps_check.sh` â†’ installs **ffmpeg**, **inotify-tools**, **ImageMagick**  
2. `make build` â†’ compiles `src/thread_converter.c` â†’ `bin/thread_converter`

### ğŸ¤– Usage
(Optional) generate sample media:
```bash
make test
```

Run the main script:
```bash
scripts/convertisseur_multimedia.sh [options] <source_dir>
```

**Common options**  
| Flag   | Description                                      |
|--------|--------------------------------------------------|
| `-h`   | show help                                        |
| `-f`   | fork mode (`&`)                                  |
| `-s`   | subshell mode                                    |
| `-t`   | thread mode (uses `bin/thread_converter`)        |
| `-j N` | number of threads (with `-t`)                    |
| `-l DIR`| custom log directory                            |
| `-r`   | restore last backup                              |

**Example**  
```bash
scripts/convertisseur_multimedia.sh -t -j 4 test_files
```

### ğŸ§ª Testing
```bash
make test
scripts/convertisseur_multimedia.sh -f test_files
scripts/convertisseur_multimedia.sh -s test_files
scripts/convertisseur_multimedia.sh -t -j 2 test_files
```
- Check `output/` for converted files.  
- Check `backup/<timestamp>/` for originals.  
- Check `logs/history.log` or `/var/log/.../history.log` for detailed logs.

---

## ğŸ”° Contributing
1. Fork & clone  
2. Create a branch (`git checkout -b feature/xyz`)  
3. Commit, push, PR  
4. Follow shell style (use `shfmt`)

---

## ğŸ— License
MIT â€” see [LICENSE](LICENSE)

---

## ğŸ™Œ Acknowledgments
Built with â¤ï¸ using `ffmpeg`, `inotify-tools`, and `ImageMagick`.
